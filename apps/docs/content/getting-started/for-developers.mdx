import { Steps } from 'nextra/components';
import { Callout } from 'nextra/components';
import { Pre } from 'nextra/components';

# 给开发者（本地运行）

本指南面向希望在本地环境运行、开发、或二次定制本项目的开发者。

## 环境要求

在开始之前，请确保你的开发环境中安装了以下工具：

- **Node.js**: `v22.x` 或更高版本。
- **pnpm**: `v10.x` 或更高版本。我们使用 pnpm 进行高效的依赖管理。

<Steps>

### 第一步：克隆项目

将项目代码克隆到你的本地机器。

<Pre>
  <code>
    git clone https://github.com/bosens-China/yliu-blog-engine.git cd
    yliu-blog-engine
  </code>
</Pre>

### 第二步：安装依赖

进入项目根目录后，使用 pnpm 安装所有依赖。

<Pre>
  <code>pnpm install</code>
</Pre>

<Callout>
  本项目使用 Monorepo 结构，`pnpm install` 会自动安装所有 `apps/*` 和
  `packages/*` 子包的依赖，并将它们链接起来。
</Callout>

### 第三步：配置环境变量

1.  在项目根目录下，复制 `.env.example` 文件并重命名为 `.env`。

    <Pre>
      <code>cp .env.example .env</code>
    </Pre>

2.  打开 `.env` 文件，并至少填写以下**必需**的配置：

    ```env
    # 【必需】指定你的 GitHub 仓库，格式为 "用户名/仓库名"
    # 这个仓库将作为你博客文章的来源。
    NEXT_PUBLIC_GITHUB_REPOSITORY="your-github-username/your-repo-name"

    # 【强烈推荐】你的 GitHub 个人访问令牌
    # 用于提高 API 请求速率限制，避免在拉取大量 issues 时失败。
    GITHUB_TOKEN="ghp_xxxxxxxxxxxxxxxxx"
    ```

    <Callout type="info">
      所有可用的环境变量，请参考
      [配置选项参考](/reference/environment-variables) 页面。
    </Callout>

### 第四步：构建数据

在启动 Next.js 开发服务器之前，你需要先运行我们的数据处理脚本，它会从你的 GitHub 仓库拉取 Issues 并生成供前端使用的数据文件。

<Pre>
  <code># 这个命令会执行 packages/scripts 中的构建脚本 pnpm build:data</code>
</Pre>

这个脚本会生成 `apps/web/src/data/blog-data.json` 文件，并下载图片（如果需要）。

### 第五步：启动开发服务器

现在，你可以启动 Next.js 的开发服务器了。

<Pre>
  <code># 这个命令会启动 apps/web 的开发服务器 pnpm dev</code>
</Pre>

服务器启动后，在浏览器中访问 `http://localhost:3000`，你应该就能看到一个使用你的 GitHub Issues 作为文章内容的本地博客了。

### 开发流程总结

你的日常开发流程将会是：

1.  在你的 GitHub 仓库中更新或创建 Issues。
2.  在本地终端中，重新运行 `pnpm build:data` 来同步最新的文章数据。
3.  Next.js 的开发服务器会自动热更新，在浏览器上展示最新的内容。

</Steps>
